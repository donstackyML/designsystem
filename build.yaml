trigger:
  batch: true
  branches:
    include:
      - master
      - Releases/*
    exclude:
      - refs/tags/no-build
  tags:
    exclude:
      - '*'

pool:
  name: 'tfs-ext-pool-1'
  demands:
    - npm

steps:
  - checkout: self

  - task: Bash@3
    displayName: Install
    inputs:
      targetType: 'inline'
      script: |
        npm config set https-proxy http://proxy-ext.sandbox.local:8080
        npm install
      workingDirectory: $(Build.SourcesDirectory)

  - task: Bash@3
    displayName: Restore dx-custom-themes projects
    inputs:
      targetType: 'inline'
      script: |
        npm run build-storybook
      workingDirectory: $(Build.SourcesDirectory)
