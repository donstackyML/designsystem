@use 'sass:math';
@use 'sass:color';
@use 'colors' as *;
@use '../colors' as *;
@use 'sizes' as *;
@use '../sizes' as *;
@use '../../base/icons' as *;
@use '../button/colors' as *;
@use '../button/sizes' as *;
@use '../button/mixins' as *;
@use '../checkBox/colors' as *;
@use '../../base/list';
@use '../../base/list/mixins' as *;
@use '../../generic/typography/index' as *;

// adduse
@use '../badge';

$generic-mobile-list-item-horizontal-padding: 15px;

$generic-list-border: $generic-list-border-width solid $list-border-color;
$generic-list-item-border: $generic-list-item-border-width solid $list-border-color;
$generic-list-search-editor-height: round($generic-base-line-height * $generic-base-font-size) + $generic-base-inline-borderedwidget-top-padding + $generic-base-inline-borderedwidget-bottom-padding + 2 * $generic-base-border-width;

.dx-list-item-chevron {
  transform: rotate(0);
  border: none;
  opacity: 1;

  .dx-rtl & {
    transform: rotate(0);
  }

  @include dx-icon(chevronnext);
  @include dx-icon-sizing($generic-base-icon-size);

  margin-left: -5px;
  color: $list-item-chevron-icon-color;
}

.dx-list-item-icon-container {
  width: $generic-base-icon-size + $generic-list-item-horizontal-padding;
  height: $generic-base-icon-size;
  vertical-align: top;
}

.dx-list-item-icon {
  @include dx-icon-sizing($generic-base-icon-size);
}

.dx-list>.dx-list-search.dx-texteditor.dx-editor-outlined {
  background-color: $listsearch-filled-bg;
  border-color: transparent;

  &.dx-state-hover {
    background-color: $listsearch-hover-bg;
  }

  &.dx-state-focused,
  &.dx-state-active {
    background-color: $listsearch-focused-bg;
    border-color: $listsearch-hover-border-color;
  }
}

.dx-list-search {
  margin-bottom: $generic-list-searchbox-margin-bottom;
}

.dx-dropdownmenu-list .dx-toolbar-menu-section .dx-list-item.dx-toolbar-menu-custom.dx-state-hover {
  background: none;

  .dx-button:not(.dx-buttongroup-item-content) {
    background: $list-focused-bg;
    border-radius: 0;
  }
}

@mixin item-states() {

  &.dx-state-hover,
  &:hover {
    background-color: $list-item-hover-bg;
    color: $list-item-hover-color;

    .dx-icon {
      color: $list-item-hover-color;
    }

    @include toggle-delete-icon($list-item-hover-color);
  }

  &.dx-list-item-selected {
    background-color: $list-item-selected-bg;
    color: $list-item-selected-color;

    .dx-icon {
      color: $list-item-selected-color;
    }

    &.dx-state-hover:not(.dx-state-focused),
    &:hover:not(.dx-state-focused) {
      background-color: $list-item-hover-bg;
      color: $list-item-color;
    }

    @include toggle-delete-icon($list-item-selected-color);
  }

  &.dx-state-focused:not(.me-list .dx-list-item) {
    background-color: $list-focused-bg;
    box-shadow: inset 0px 0px 0px 2px #7eb9ff, inset 0px 0px 0px 4px #ffffff;
    color: $list-item-focus-color;

    .dx-icon {
      color: $list-item-focus-color;
    }

    .dx-list-item-chevron {
      border-color: $list-chevron-focus-color;
    }

    @include toggle-delete-icon($list-item-focus-color);
  }

  &.dx-state-focused.dx-list-item-selected {
    background-color: $list-item-focused-selected-bg;
    color: $base-text-color;
  }

  &.dx-state-focused.dx-state-active,
  &:active {
    background-color: $list-item-active-bg;
    color: $list-item-active-color;

    .dx-icon {
      color: $list-item-active-color;
    }

    .dx-list-slide-item-content {
      background-color: $list-item-active-bg;
      color: $list-item-active-color;
    }

    @include toggle-delete-icon($list-item-active-color);
  }

  .dx-icon {
    color: $list-icon-color;
  }

  &.dx-state-active,
  &.dx-state-focused {
    .dx-button .dx-icon {
      color: $button-icon-color;
    }
  }
}

@mixin dx-list-sizing($item-horizontal-padding) {
  .dx-list {
    border: none;

    &.dx-list-with-search .dx-scrollable-wrapper {
      height: calc(100% - #{round($generic-list-search-editor-height + $generic-list-searchbox-margin-bottom)});
    }

    .dx-empty-message {
      text-align: left;
    }

    &.dx-list-select-decorator-enabled {

      .dx-list-item,
      .dx-list-select-all {
        &.dx-state-hover {

          .dx-radiobutton-icon::before,
          .dx-checkbox-icon {
            border-color: $checkbox-hover-border-color;
          }
        }

        &.dx-state-focused {

          .dx-radiobutton-icon::before,
          .dx-checkbox-icon {
            border: 1px solid $checkbox-focused-borderd-color;
          }
        }
      }
    }

    &:not(.dx-list-select-decorator-enabled),
    &.me-list {

      .dx-list-item,
      &.dx-list-collapsible-groups .dx-list-group-header {
        @include item-states();
      }
    }
  }

  .dx-list-group-header {
    font-weight: bold;
    padding: $generic-list-group-header-vertical-padding $item-horizontal-padding $generic-list-item-vertical-padding $item-horizontal-padding;
    border-top: $generic-list-item-border;
    border-bottom: $list-group-header-border-bottom;
    background: $list-group-header-bg;
    color: $list-group-color;

    .dx-list-group:first-of-type & {
      border-top: none;
    }

    &::before {
      border-top-color: $list-group-color;
    }

    .dx-list-group-collapsed &::before {
      border-bottom-color: $list-group-color;
    }
  }

  .me-list.dx-list {
    .dx-list-group {
      margin-top: 16px;
    }

    .dx-list-group-header {
      .me-text-body2 {
        margin-top: 4px;
      }

      border-bottom: none;
      border-top: none;
      padding: 8px 14px 8px 8px;

      &:not(:has(.me-text-body2)) {
        padding: 12px 14px 12px 8px;
      }
    }

    &.dx-list-select-decorator-enabled {

      .dx-list-item,
      .dx-list-select-all {
        &.dx-state-focused {

          .dx-radiobutton-icon::before,
          .dx-checkbox-icon {
            border-color: $checkbox-checked-bg;
          }
        }
      }
    }

    .dx-list-item-icon {
      width: 24px;
      height: 24px;
    }

    .dx-list-item {
      display: flex;
      align-items: center;
    }

    .dx-list-item-content {
      width: auto;
      flex-grow: 1;
      line-height: 20px;

      &::before {
        content: none;
      }

      display: flex;
      align-items: center;
      gap: 8px;

      & .me-text-caption {
        margin-top: 2px;
      }
    }

    .dx-list-item-icon-container {
      width: 24px;
      height: 24px;
    }
  }

  .dx-list-item {
    &:first-of-type {
      border-top: none;
    }

    &:last-of-type {
      border-bottom: none;
    }

    .dx-icon-toggle-delete {
      background-size: 100%;
    }

    @include toggle-delete-icon($list-icon-color);

    &.dx-item.dx-list-item-ghost-reordering {
      &.dx-state-focused {
        &.dx-state-hover {
          color: $list-item-ghost-color;
          background: $list-item-ghost-bg;
          border-top: 1px solid $list-item-ghost-border-color;
          border-bottom: 1px solid $list-item-ghost-border-color;
          box-shadow: 0 1px 4px $list-item-ghost-shadow-color;

          .dx-list-reorder-handle {
            background: $list-reorder-handle-dragging;

            &::before {
              content: none;
            }
          }
        }
      }
    }
  }

  .dx-list-item,
  .dx-list .dx-empty-message {
    border-top: $generic-list-item-border;
    color: $list-normal-color;

    .dx-list-item-separator-hidden & {
      border-top: none;
      border-bottom: none;
    }
  }

  .dx-list-item-content,
  .dx-list .dx-empty-message {
    padding: $generic-list-item-vertical-padding $item-horizontal-padding;

    .me-list & {
      padding: 8px;
    }
  }

  .me-list {
    .dx-list-item-after-bag {
      &.dx-list-reorder-handle-container {
        width: 34px;
      }

      .dx-list-reorder-handle {
        width: 20px;
        height: 20px;
        background: $list-reorder-handle;

        &::before {
          content: none;
        }
      }
    }

    .dx-list-group-header {
      @extend %me-title-header1;

      &::before {
        width: 20px;
        height: 20px;
        background: $list-expand-button;
        border: none;
        margin-top: 2px;
        transition: all ease 0.3s;
      }

      &:has(.me-title-header1) {
        &::before {
          margin-top: 14px;
        }
      }
    }

    .dx-list-group-collapsed .dx-list-group-header::before {
      transform: rotate(180deg);
      transition: all ease 0.3s;
    }

    .dx-list-item-before-bag {

      .dx-list-select-checkbox,
      .dx-list-select-radiobutton {
        margin-left: 8px;
      }
    }

    .dx-list-select-all-checkbox {
      margin-left: 8px;
    }

    .dx-list-item-before-bag.dx-list-select-checkbox-container {
      width: 28px;
    }
  }

  .dx-list-next-button .dx-button {
    @include dx-button-withtext-sizing();
  }

  .dx-list-item-chevron-container {
    width: 6px + $item-horizontal-padding;
  }

  .dx-list-border-visible {
    border: $generic-list-border;

    .dx-list-select-all {
      border-bottom: $generic-list-border;
    }
  }

  .dx-list-item-before-bag {
    &.dx-list-toggle-delete-switch-container {
      width: $item-horizontal-padding + 19px;
    }

    &.dx-list-select-checkbox-container,
    &.dx-list-select-radiobutton-container {
      width: $item-horizontal-padding + 21px;
    }

    .dx-button.dx-list-toggle-delete-switch {
      border: none;
      background: transparent;
      box-shadow: none;

      .dx-button-content {
        padding: 0;
      }
    }

    .dx-icon-toggle-delete {
      margin: math.div($generic-list-item-vertical-padding, 2) math.div($item-horizontal-padding, 2) math.div($generic-list-item-vertical-padding, 2) $item-horizontal-padding;
      width: 9px + $generic-list-item-vertical-padding;
      height: 9px + $generic-list-item-vertical-padding;
    }

    .dx-list-select-checkbox,
    .dx-list-select-radiobutton {
      margin-top: $generic-list-select-all-margin-top;
      margin-bottom: -3px;
      margin-left: $item-horizontal-padding;
    }
  }

  .dx-list-select-all {
    padding: $generic-list-item-vertical-padding - 1px 0 $generic-list-item-vertical-padding - 2px;
  }

  .dx-list-select-all-checkbox {
    float: left;
    margin: -1px $generic-list-select-all-margin-right -3px $item-horizontal-padding;
  }

  .dx-list-select-all-label {
    line-height: $generic-list-select-all-label-line-height;
    padding: 0 $generic-list-item-horizontal-padding;
    margin-top: $generic-list-select-all-label-margin-top;
  }

  .dx-list-item-after-bag {
    &.dx-list-static-delete-button-container {
      width: $item-horizontal-padding + $generic-button-icon-size + $generic-list-deletebutton-padding * 2 + $generic-button-border-weight * 2;
    }

    &.dx-list-reorder-handle-container {
      width: $item-horizontal-padding + $generic-base-icon-size * 1.3;
    }

    .dx-list-reorder-handle {
      @include dx-icon(dragvertical);
      @include dx-icon-sizing($generic-base-icon-size, $generic-base-icon-size * 1.6);
    }
  }

  .dx-list-slide-menu-button {
    bottom: 1px;
  }

  .dx-list-slide-menu-button-delete {
    border: 1px solid transparent;
    color: $list-menu-button-delete-color;
    background-color: $list-menu-button-delete-bg;
  }

  .dx-list-slide-menu-button-menu {
    border: 1px solid transparent;
    color: $list-menu-button-default-color;
    background-color: $list-menu-button-default-bg;
  }

  .dx-list-switchable-delete-button,
  .dx-list-static-delete-button {
    margin-right: $item-horizontal-padding;
    padding: 0;

    .dx-button-content {
      padding: $generic-list-deletebutton-padding;
    }
  }

  .dx-list-context-menucontent {
    background-color: $list-holdmenu-bg;
    border: 1px solid $list-holdmenu-border-color;
    border-radius: 0;
    box-shadow: 0 3px 10px $list-holdmenu-shadow-color;
  }

  .dx-state-disabled {

    &.dx-list-item,
    .dx-list-item {
      background-color: transparent;
      opacity: 0.6;
    }
  }

  .dx-rtl .dx-list,
  .dx-rtl.dx-list {
    .dx-empty-message {
      text-align: right;
    }

    .dx-list-item-before-bag {
      .dx-icon-toggle-delete {
        margin: math.div($generic-list-item-vertical-padding, 2) $item-horizontal-padding math.div($generic-list-item-vertical-padding, 2) math.div($item-horizontal-padding, 2);
      }

      .dx-list-select-checkbox,
      .dx-list-select-radiobutton {
        margin-right: $item-horizontal-padding;
        margin-left: 1px;
      }
    }

    .dx-list-select-all-checkbox {
      float: right;
      margin-right: $item-horizontal-padding;
      margin-left: 1px;
    }

    .dx-list-switchable-delete-button {
      margin-left: $item-horizontal-padding;
      margin-right: 0;
    }
  }
}

@include dx-list-sizing($generic-list-item-horizontal-padding);

.dx-device-mobile {
  @include dx-list-sizing($generic-mobile-list-item-horizontal-padding);
}

.me-list {
  &.dx-list:not(.dx-list-select-decorator-enabled) .dx-list-item {
    &.dx-state-hover {
      .dx-icon-toggle-delete {
        background-image: $list-toggle-delete-button;
      }
    }

    .dx-icon-toggle-delete {
      background-image: $list-toggle-delete-button;
    }
  }

  .dx-list-item-after-bag.dx-list-static-delete-button-container {
    width: 44px;
    padding: 8px;
  }
}

.me-list .dx-button-mode-contained.dx-list-static-delete-button {
  margin: 0;

  & .dx-button-content {
    .dx-icon-remove {
      width: 20px;
      height: 20px;
      background: $list-remove-button;
      background-size: contain;

      &:before {
        content: none;
      }
    }

    padding: 3px;
  }
}

.me-list-item-more {
  @extend %me-text-body2;

  margin-left: auto;
}

.me-list {
  background: $me-list-bg;
  padding: 8px;

  .dx-list-search {
    margin-bottom: 16px;
  }

  .dx-list-switchable-delete-button-container {
    .dx-list-switchable-delete-button {
      margin-right: 8px;
    }

    .dx-button-text {
      font-size: 0;
      width: 20px;
      height: 20px;
      background: $list-remove-button;
      background-size: contain;
    }

    .dx-button-content {
      padding: 3px;
    }
  }

  .dx-list-group-header {
    background: transparent;
  }

  .dx-scrollable-content {
    transform: translate(0, 0) !important;
  }
}

.me-list .dx-button-mode-contained {

  &.dx-list-static-delete-button,
  &.dx-list-switchable-delete-button {
    border: 1px solid $base-danger;
  }
}