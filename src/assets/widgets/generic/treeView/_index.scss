@use 'sass:color';
@use 'colors' as *;
@use '../colors' as *;
@use 'sizes' as *;
@use '../sizes' as *;
@use '../../base/treeView' as *;
@use '../../base/icons' as *;
@use '../checkBox/colors' as *;

// adduse

$generic-treeview-search-editor-height: round($generic-base-line-height * $generic-base-font-size) +
  $generic-base-inline-borderedwidget-top-padding +
  $generic-base-inline-borderedwidget-bottom-padding + 2 * $generic-base-border-width;
$generic-treeview-toggle-item-visibility-offset: -4px;

.dx-treeview-node-loadindicator {
  top: $generic-treeview-loadincicator-offset-top;
  left: $generic-treeview-loadincicator-offset-left;
  width: $generic-treeview-loadincicator-size;
  height: $generic-treeview-loadincicator-size;
}

.dx-treeview {
  &.dx-rtl {
    @include dx-treeview-make-rtl(
      $generic-treeview-container-with-border-offset,
      $generic-treeview-node-offset,
      $generic-treeview-item-with-checkbox-offset,
      $generic-treeview-checkbox-offset,
      $generic-select-all-text-offset,
      $generic-select-all-item-left-padding,
      $generic-treeview-border-padding
    );

    .dx-treeview-toggle-item-visibility {
      right: $generic-treeview-toggle-item-visibility-offset;
    }

    .dx-treeview-item-with-checkbox .dx-checkbox {
      overflow: visible;
    }
  }
}

.dx-treeview-search {
  margin-bottom: $generic-treeview-searchbox-margin-bottom;
}

.dx-treeview-with-search > .dx-scrollable {
  height: calc(
    100% - #{round(
        $generic-treeview-search-editor-height + $generic-treeview-searchbox-margin-bottom
      )}
  );
}

.dx-treeview-border-visible {
  border: 1px solid $treeview-border-color;

  .dx-treeview-select-all-item {
    padding-left: $generic-select-all-item-left-padding;
  }

  .dx-scrollable-content {
    > .dx-treeview-node-container {
      padding: $generic-treeview-container-padding;
    }
  }
}

.dx-treeview-select-all-item {
  margin: 0 0 $generic-treeview-container-with-border-offset 0;
  border-bottom: 1px solid $treeview-border-color;
  padding: $generic-select-all-item-padding;
  display: flex;
  align-items: center;

  .dx-checkbox-text {
    padding-left: $generic-select-all-text-offset;
  }
}

.dx-treeview-node {
  padding-left: $generic-treeview-node-offset;
}

.dx-state-selected {
  > .dx-treeview-item {
    color: $treeview-item-selected-color;
  }
}

.dx-treeview-item-with-checkbox {
  .dx-treeview-item {
    color: $base-text-color;
    padding-left: $generic-treeview-item-with-checkbox-offset;
  }

  .dx-checkbox {
    top: 5px;
    left: $generic-treeview-checkbox-offset;
  }

  &.dx-state-focused {
    > .dx-checkbox .dx-checkbox-icon {
      border: 1px solid $checkbox-focused-borderd-color;
    }
  }
}

.dx-treeview-item-without-checkbox {
  &.dx-state-selected {
    > .dx-treeview-item {
      color: $treeview-item-selected-color;
      background-color: $treeview-item-selected-bg;
    }

    &:not(.dx-state-focused) {
      > .dx-treeview-item {
        &.dx-state-hover {
          background-color: $treeview-item-selected-hover-bg;
        }
      }
    }
  }

  &.dx-state-focused {
    > .dx-treeview-item {
      box-shadow: inset 0px 0px 0px 2px #7eb9ff, inset 0px 0px 0px 4px #ffffff;
      z-index: 1;
      color: $treeview-color;
    }
  }
}

.dx-treeview-item {
  padding: $generic-treeview-item-padding;
  min-height: $generic-treeview-min-item-height;
  border-radius: 3px;

  .dx-treeview-item-content > .dx-icon {
    @include dx-icon-sizing($generic-base-icon-size);
  }

  &.dx-state-hover {
    background-color: $treeview-hover-bg;
    color: $treeview-item-hover-color;
  }
}

.dx-treeview-toggle-item-visibility {
  @include dx-icon(spinright);
  @include dx-icon-font-centered-sizing($generic-treeview-arrow-icon-size);

  color: $treeview-spin-icon-color;
  width: $generic-treeview-toggle-item-width;
  height: $generic-treeview-min-item-height;
  top: 0;
  left: $generic-treeview-toggle-item-visibility-offset;

  &.dx-treeview-toggle-item-visibility-opened {
    @include dx-icon(spindown);
    @include dx-icon-font-centered-sizing($generic-treeview-arrow-icon-size);
  }
}

.dx-treeview {
  .me-state-selected {
    background-color: $treeview-focused-bg;
  }
}

.me-tree-view {
  display: flex;
  padding: 8px;
  gap: 4px;

  .dx-scrollable {
    width: -webkit-fill-available;

    li.dx-treeview-node {
      padding-left: 0;
      text-align: left;
      margin-top: 4px;

      .dx-item.dx-treeview-item {
        min-height: auto;

        .dx-treeview-toggle-item-visibility {
          left: 8px;
          background: none;
          font-family: var(--me-icon-family);
          &::before {
            content: var(--me-icon-arrow-right);
          }
          &.dx-treeview-toggle-item-visibility-opened {
            transform: rotate(90deg);
          }
        }
        .dx-item-content.dx-treeview-item-content {
          display: flex;
          align-items: flex-start;
          gap: 8px;

          .dx-icon {
            margin: 0;
          }

          span {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
          }
        }
      }
    }
  }

  &.me-tree-view-word-wrap .dx-treeview-item .dx-treeview-item-content {
    & > span {
      overflow: visible;
      white-space: pre-wrap;
      text-overflow: clip;
    }
  }

  .dx-treeview-item-with-checkbox {
    &.dx-state-selected {
      & > .dx-treeview-item {
        background-color: $treeview-item-selected-bg;
      }
    }
  }

  .dx-treeview-item-without-checkbox.dx-state-selected > .dx-treeview-item {
    background-color: $treeview-item-selected-bg;
  }

  .dx-treeview-item-without-checkbox.dx-state-focused > .dx-treeview-item {
    box-shadow: none;
  }

  &:focus-visible .dx-treeview-item-without-checkbox.dx-state-focused,
  &:focus-visible .dx-treeview-item-with-checkbox.dx-state-focused {
    & > .dx-treeview-item {
      box-shadow: inset 0px 0px 0px 2px #7eb9ff;
    }
  }

  .dx-state-active {
    background-color: $treeview-item-active-bg;
  }
  &.dx-state-disabled * {
    color: $treeview-disabled-color !important;
    fill: $treeview-disabled-color !important;
  }
  &:not(.dx-state-disabled) * {
    fill: $base-icon-color !important;
  }
}

.me-tree-view.me-tree-view-large {
  li ul {
    margin-left: 32px;
  }
  .dx-scrollable {
    li.dx-treeview-node {
      font-size: 16px;
      font-weight: var(--me-regular-font-weight);
      .dx-item.dx-treeview-item {
        padding: 8px;
        .dx-treeview-toggle-item-visibility {
          height: 24px;
          width: 24px;
          font-size: 20px;
          top: 8px;
        }
        .dx-item-content.dx-treeview-item-content {
          margin-left: 32px;
          .dx-icon {
            width: 24px;
            height: 24px;
          }
          span {
            font-size: 16px;
            font-weight: var(--me-regular-font-weight);
            line-height: 24px;
          }
        }
      }
      &.dx-treeview-item-with-checkbox {
        .dx-checkbox {
          height: 24px;
          width: 24px;
          top: 8px;
          left: auto;
          margin-left: 32px;
        }
        .dx-item.dx-treeview-item {
          .dx-item-content.dx-treeview-item-content {
            margin-left: 64px;
          }
        }
      }
    }
  }
}

.me-tree-view.me-tree-view-small {
  li ul {
    margin-left: 28px;
  }
  .dx-scrollable {
    li.dx-treeview-node {
      font-size: 14px;
      font-weight: 400;
      .dx-item.dx-treeview-item {
        padding: 4px 8px;
        .dx-treeview-toggle-item-visibility {
          height: 20px;
          width: 20px;
          font-size: 18px;
          top: 4px;
        }

        .dx-item-content.dx-treeview-item-content {
          margin-left: 28px;
          .dx-icon {
            width: 20px;
            height: 20px;
          }
          span {
            font-size: 14px;
            font-weight: var(--me-regular-font-weight);
            line-height: 20px;
          }
        }
      }
      &.dx-treeview-item-with-checkbox {
        .dx-checkbox {
          height: 20px;
          width: 20px;
          top: 4px;
          left: auto;
          margin-left: 28px;
        }
        .dx-item.dx-treeview-item {
          .dx-item-content.dx-treeview-item-content {
            margin-left: 56px;
          }
        }
      }
    }
  }
}
